import{l as f,a as h,j as e,C as N}from"./index-CZQsGjd-.js";import{b as y}from"./cil-monitor-C7IKq9X3.js";import{C as g,a as m}from"./CRow-Ctu-Q85f.js";import{C as S,a as k}from"./CCardBody-DV2l3YLF.js";import{C as B}from"./CCardHeader-BTSib23E.js";import{C as P}from"./CForm-B1sfIlCz.js";import{C as T}from"./CFormCheck-B1_mLtEZ.js";import{C as E}from"./CButton-CI2Y2_wg.js";import{C as R,a as v,b as C,c as j,d as F,e as o}from"./CTable-DWbnG71i.js";import{C as H}from"./CAlert-CAoUiNuw.js";import{c as O}from"./cil-burn-DKRRBsQY.js";import"./DefaultLayout-BVUjKWgz.js";const z=(a,l)=>{var r,d;const t=(d=(r=a==null?void 0:a.data)==null?void 0:r.lowestPrice)==null?void 0:d.products,i=Object.keys(l);if(t)return t.sort((c,n)=>i.indexOf(c.category)-i.indexOf(n.category)),{products:t,brandName:a.data.lowestPrice.brandName,totalPrice:a.data.lowestPrice.totalPrice}},V=()=>{const a=f(s=>s.backendUrl),l=f(s=>s.categories),[t,i]=h.useState(!1),[r,d]=h.useState(null),[c,n]=h.useState(!1),[u,p]=h.useState(null),b=()=>{n(!0),p(null),fetch(a+"/api/v1/products/lowest-set?singleBrand="+t,{method:"GET",headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}}).then(s=>s.ok?s.json():s.json().then(x=>{const w=`Network error: ${s.status} - ${x.message}`;throw new Error(w)})).then(s=>{d(z(s,l)),n(!1)}).catch(s=>{p(s),n(!1)})};return e.jsx(g,{children:e.jsx(m,{xs:12,children:e.jsxs(S,{className:"mb-4",children:[e.jsx(B,{children:e.jsx("strong",{children:"최저가 세트"})}),e.jsxs(k,{children:[e.jsxs(P,{className:"row g-3 justify-content-end",onSubmit:b,children:[e.jsx(m,{xs:"auto",className:"text-end",children:e.jsx(T,{id:"singleBrand",label:"단일 브랜드",checked:t,onChange:s=>i(s.target.checked)})}),e.jsx(m,{xs:"auto",className:"text-end",children:e.jsxs(E,{type:"submit",color:"primary",variant:"outline",size:"sm",disabled:c,children:[c&&e.jsx(N,{as:"span",size:"sm","aria-hidden":"true"}),!c&&e.jsx(e.Fragment,{children:"검색"})]})})]}),(r==null?void 0:r.brandName)&&e.jsx(g,{children:e.jsx(m,{children:e.jsx("h5",{children:e.jsxs("b",{children:["브랜드: ",r.brandName]})})})}),e.jsxs(R,{hover:!0,children:[e.jsx(v,{children:e.jsxs(C,{children:[e.jsx(j,{scope:"col",children:"카테고리"}),e.jsx(j,{scope:"col",children:"브랜드"}),e.jsx(j,{scope:"col",children:"가격"})]})}),e.jsxs(F,{children:[r&&r.products.map((s,x)=>e.jsxs(C,{children:[e.jsx(o,{children:l[s.category]}),e.jsx(o,{children:s.brandName}),e.jsx(o,{children:s.price})]},x)),r&&e.jsxs(C,{children:[e.jsx(o,{colSpan:2,children:e.jsx("b",{children:"총액"})}),e.jsx(o,{children:r.totalPrice})]})]})]}),u&&e.jsxs(H,{color:"danger",className:"d-flex align-items-center",children:[e.jsx(y,{icon:O,className:"flex-shrink-0 me-2",width:24,height:24}),e.jsx("div",{children:u.message})]})]})]})})})};export{V as default};
