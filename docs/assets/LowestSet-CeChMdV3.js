import{l as f,a as h,j as e,C as N}from"./index-vWEjdDY1.js";import{b as y}from"./cil-monitor-B3oJwQN9.js";import{C as b,a as x}from"./CRow-Dc-PYaZc.js";import{C as S,a as k}from"./CCardBody-Dam5KOrS.js";import{C as B}from"./CCardHeader-Bzy8KaYG.js";import{C as P}from"./CForm-AdzqmbFD.js";import{C as T}from"./CFormCheck-DTbzh4th.js";import{C as R}from"./CButton-CgS9ie_u.js";import{C as v,a as E,b as j,c as C,d as F,e as o}from"./CTable-B-gMQnW2.js";import{C as H}from"./CAlert-CufGyYIg.js";import{c as O}from"./cil-burn-DKRRBsQY.js";import"./DefaultLayout-DmxUTzH6.js";const z=(a,l)=>{var r,d;const t=(d=(r=a==null?void 0:a.data)==null?void 0:r.lowestPrice)==null?void 0:d.products,i=Object.keys(l);if(t)return t.sort((n,c)=>i.indexOf(n.category)-i.indexOf(c.category)),{products:t,brandName:a.data.lowestPrice.brandName,totalPrice:a.data.lowestPrice.totalPrice}},V=()=>{const a=f(s=>s.backendUrl),l=f(s=>s.categories),[t,i]=h.useState(!1),[r,d]=h.useState(null),[n,c]=h.useState(!1),[u,p]=h.useState(null),g=()=>{c(!0),p(null),fetch(a+"/api/v1/products/lowest-set?singleBrand="+t).then(s=>s.ok?s.json():s.json().then(m=>{const w=`Network error: ${s.status} - ${m.message}`;throw new Error(w)})).then(s=>{d(z(s,l)),c(!1)}).catch(s=>{p(s),c(!1)})};return e.jsx(b,{children:e.jsx(x,{xs:12,children:e.jsxs(S,{className:"mb-4",children:[e.jsx(B,{children:e.jsx("strong",{children:"최저가 세트"})}),e.jsxs(k,{children:[e.jsxs(P,{className:"row g-3 justify-content-end",onSubmit:g,children:[e.jsx(x,{xs:"auto",className:"text-end",children:e.jsx(T,{id:"singleBrand",label:"단일 브랜드",checked:t,onChange:s=>i(s.target.checked)})}),e.jsx(x,{xs:"auto",className:"text-end",children:e.jsxs(R,{type:"submit",color:"primary",variant:"outline",size:"sm",disabled:n,children:[n&&e.jsx(N,{as:"span",size:"sm","aria-hidden":"true"}),!n&&e.jsx(e.Fragment,{children:"검색"})]})})]}),(r==null?void 0:r.brandName)&&e.jsx(b,{children:e.jsx(x,{children:e.jsx("h5",{children:e.jsxs("b",{children:["브랜드: ",r.brandName]})})})}),e.jsxs(v,{hover:!0,children:[e.jsx(E,{children:e.jsxs(j,{children:[e.jsx(C,{scope:"col",children:"카테고리"}),e.jsx(C,{scope:"col",children:"브랜드"}),e.jsx(C,{scope:"col",children:"가격"})]})}),e.jsxs(F,{children:[r&&r.products.map((s,m)=>e.jsxs(j,{children:[e.jsx(o,{children:l[s.category]}),e.jsx(o,{children:s.brandName}),e.jsx(o,{children:s.price})]},m)),r&&e.jsxs(j,{children:[e.jsx(o,{colSpan:2,children:e.jsx("b",{children:"총액"})}),e.jsx(o,{children:r.totalPrice})]})]})]}),u&&e.jsxs(H,{color:"danger",className:"d-flex align-items-center",children:[e.jsx(y,{icon:O,className:"flex-shrink-0 me-2",width:24,height:24}),e.jsx("div",{children:u.message})]})]})]})})})};export{V as default};
