import{l as p,a as l,j as e,C as w}from"./index-va5UnrO5.js";import{b as S}from"./cil-monitor-Ecr67Ieb.js";import{C as u,a as n}from"./CRow-CEbGi0CQ.js";import{C as N,a as T}from"./CCardBody-DbCALLaK.js";import{C as E}from"./CCardHeader-DmksiN5A.js";import{C as k}from"./CForm-ChVYDIkQ.js";import{C as v}from"./CFormSelect-BVjZoCyn.js";import{C as H}from"./CButton-DDicmkuX.js";import{C as R,a as B,b as x,c as C,d as P,e as c}from"./CTable-DSEzf_iF.js";import{C as z}from"./CAlert-STpO8U16.js";import{c as F}from"./cil-burn-DKRRBsQY.js";import"./DefaultLayout-pZoWm_zp.js";const L=a=>{var t,o,i,s;if(a.data.lowestPrice.products,a!=null&&a.data)return{category:a.data.category,lowest:(o=(t=a.data.lowestPrice)==null?void 0:t.products)==null?void 0:o[0],highest:(s=(i=a.data.highestPrice)==null?void 0:i.products)==null?void 0:s[0]}},J=()=>{const a=p(r=>r.backendUrl),t=p(r=>r.categories),[o,i]=l.useState(Object.keys(t)[0]),[s,f]=l.useState(null),[d,h]=l.useState(!1),[j,g]=l.useState(null),b=()=>{h(!0),g(null),fetch(a+"/api/v1/products/by-category?price=LOWEST_HIGHEST&category="+o,{method:"GET",headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}}).then(r=>r.ok?r.json():r.json().then(m=>{const y=`Network error: ${r.status} - ${m.message}`;throw new Error(y)})).then(r=>{f(L(r)),h(!1)}).catch(r=>{g(r),h(!1)})};return e.jsx(u,{children:e.jsx(n,{xs:12,children:e.jsxs(N,{className:"mb-4",children:[e.jsx(E,{children:e.jsx("strong",{children:"최저/최고가 카테고리"})}),e.jsxs(T,{children:[e.jsxs(k,{className:"row g-3 justify-content-end",onSubmit:b,children:[e.jsx(n,{xs:"auto",className:"text-end",children:e.jsx(v,{"aria-label":"카테고리",size:"sm",defaultValue:o,onChange:r=>i(r.target.value),children:Object.entries(t).map(([r,m])=>e.jsx("option",{value:r,children:m}))})}),e.jsx(n,{xs:"auto",className:"text-end",children:e.jsxs(H,{type:"submit",color:"primary",variant:"outline",size:"sm",disabled:d,children:[d&&e.jsx(w,{as:"span",size:"sm","aria-hidden":"true"}),!d&&e.jsx(e.Fragment,{children:"검색"})]})})]}),(s==null?void 0:s.category)&&e.jsx(u,{children:e.jsx(n,{children:e.jsx("h5",{children:e.jsxs("b",{children:["카테고리: ",t[s.category]]})})})}),e.jsxs(R,{hover:!0,children:[e.jsx(B,{children:e.jsxs(x,{children:[e.jsx(C,{scope:"col"}),e.jsx(C,{scope:"col",children:"브랜드"}),e.jsx(C,{scope:"col",children:"가격"})]})}),e.jsxs(P,{children:[(s==null?void 0:s.lowest)&&e.jsxs(x,{children:[e.jsx(c,{children:"최저가"}),e.jsx(c,{children:s.lowest.brandName}),e.jsx(c,{children:s.lowest.price})]},0),(s==null?void 0:s.highest)&&e.jsxs(x,{children:[e.jsx(c,{children:"최고가"}),e.jsx(c,{children:s.highest.brandName}),e.jsx(c,{children:s.highest.price})]},1)]})]}),j&&e.jsxs(z,{color:"danger",className:"d-flex align-items-center",children:[e.jsx(S,{icon:F,className:"flex-shrink-0 me-2",width:24,height:24}),e.jsx("div",{children:j.message})]})]})]})})})};export{J as default};
